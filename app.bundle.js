!function(){"use strict";class s{constructor(){this.prevRandomPosition=0}getRandomPosition(){let s;do{s=Math.floor(16*Math.random())}while(this.prevRandomPosition===s);return this.prevRandomPosition=s,s}}const t=new class{constructor(){this.gameEls={hits:null,skip:null,gameBoard:null,startBtn:null,gameMessage:null,goblin:null},this.startBtnListeners=[],this.gameBoardListeners=[],this.boardSize=4,this.cells=[]}init(){this.gameEls.startBtn=document.querySelector(".start"),this.gameEls.startBtn.addEventListener("click",this.onStartBtnClick.bind(this)),this.gameEls.hits=document.querySelector(".hits"),this.gameEls.skip=document.querySelector(".skip"),this.gameEls.gameBoard=document.querySelector(".game-board"),this.gameEls.gameBoard.addEventListener("click",this.onGameBoardClick.bind(this)),this.gameEls.gameMessage=document.querySelector(".game-message"),this.createGoblin(),this.drawBoard()}onStartBtnClick(){this.startBtnListeners.forEach(s=>s())}onGameBoardClick(s){this.gameBoardListeners.forEach(t=>t(s.target))}setInitialValues(s){this.gameEls.hits.textContent="0",this.gameEls.skip.textContent=`${s}`}setHitsValue(s){this.gameEls.hits.textContent=`${s}`}setSkipValue(s){this.gameEls.skip.textContent=`${s}`}showGameMessage(){this.gameEls.gameMessage.classList.remove("hidden")}hideGameMessage(){this.gameEls.gameMessage.classList.add("hidden")}drawBoard(){for(let s=0;s<this.boardSize**2;s+=1){const s=document.createElement("div");s.classList.add("cell"),this.cells.push(s)}this.gameEls.gameBoard.append(...this.cells)}createGoblin(){this.gameEls.goblin=document.createElement("img"),this.gameEls.goblin.classList.add("goblin"),this.gameEls.goblin.src="img/goblin.png",this.gameEls.goblin.dataset.goblin="true"}showGoblin(){this.gameEls.goblin.classList.remove("hidden")}hideGoblin(){this.gameEls.goblin.classList.add("hidden")}moveGoblin(s){this.cells[s].append(this.gameEls.goblin)}},i=new class{constructor(t){this.gamePlay=t,this.isGameRunning=!1,this.goblinDelay=1e3,this.position=new s,this.try={success:!1},this.hits=0,this.skip={maxCount:5,currentCount:void 0}}init(){this.gamePlay.init(),this.gamePlay.startBtnListeners.push(this.onStartBtnClick.bind(this)),this.gamePlay.gameBoardListeners.push(this.onGameBoardClick.bind(this)),this.gamePlay.setInitialValues(this.skip.maxCount)}onStartBtnClick(){this.isGameRunning||(this.isGameRunning=!0,this.gamePlay.setInitialValues(this.skip.maxCount),this.hits=0,this.skip.currentCount=this.skip.maxCount,this.gamePlay.hideGameMessage(),setTimeout(()=>{this.gamePlay.showGoblin(),this.gamePlay.moveGoblin(this.position.getRandomPosition());const s=setInterval(()=>{this.try.success||(this.skip.currentCount-=1,this.gamePlay.setSkipValue(this.skip.currentCount),0===this.skip.currentCount&&(clearInterval(s),this.gamePlay.hideGoblin(),this.gamePlay.showGameMessage(),this.isGameRunning=!1)),this.try.success=!1,this.gamePlay.moveGoblin(this.position.getRandomPosition())},this.goblinDelay)},this.goblinDelay))}onGameBoardClick(s){if(!this.isGameRunning)return;const t="true"===s.dataset.goblin;!this.try.success&&t&&(this.try.success=!0,this.hits+=1,this.gamePlay.setHitsValue(this.hits))}}(t);i.init()}();